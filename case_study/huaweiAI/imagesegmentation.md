# This is the case of fuzzing `Image Segmentation` of [huawei ai service](https://developer.huawei.com/consumer/cn/doc/overview/HUAWEI_HiAI).

## S1:
We firstly remove the `interface token and transaction code filter` to collect all interfaces related to the test case (Image Segmentation -> Image Segmentation -> Select an image -> Select `sky` as the target).
The transactions we collected:

| # | transaction code | interface token | interface method | 
| ----| :----: | :----: | :---- |
| 1 | 2 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_bindDeathMonitor(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, android::sp\<vendor::huawei::hardware::ai::hidlrequest::V1_0::IDeathMonitor> const&) | 
| 2 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 3 | 3 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_setListener(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, android::sp\<vendor::huawei::hardware::ai::hidlrequest::V1_0::IHidlListener> const&) | 
| 4 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 5 | 25 | 	vendor.huawei.hardware.ai@1.3::IAiEngineService| vendor::huawei::hardware::ai::V1_3::BpHwAiEngineService::_hidl_createAiModelMngr_1_3(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, android::sp\<vendor::huawei::hardware::ai::V1_0::IAiMMListenerProxy> const&, android::sp\<vendor::huawei::hardware::ai::V1_3::IAiMMMemAllocatorProxy> const&, unsigned int) | 
| 6 | 8 | 	vendor.huawei.hardware.ai@1.1::IAiModelMngr| vendor::huawei::hardware::ai::V1_1::BpHwAiModelMngr::_hidl_registerInstance(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, bool) | 
| 7 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 8 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 9 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 10 | 2 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_bindDeathMonitor(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, android::sp\<vendor::huawei::hardware::ai::hidlrequest::V1_0::IDeathMonitor> const&) | 
| 11 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 12 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 13 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 14 | 2 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_bindDeathMonitor(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, android::sp\<vendor::huawei::hardware::ai::hidlrequest::V1_0::IDeathMonitor> const&) | 
| 15 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 16 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 17 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 18 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 19 | 2 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_bindDeathMonitor(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, android::sp\<vendor::huawei::hardware::ai::hidlrequest::V1_0::IDeathMonitor> const&) | 
| 20 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 21 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 22 | 2 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_bindDeathMonitor(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, android::sp\<vendor::huawei::hardware::ai::hidlrequest::V1_0::IDeathMonitor> const&) | 
| 23 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 24 | 8 | 	vendor.huawei.hardware.ai@1.1::IAiModelMngr| vendor::huawei::hardware::ai::V1_1::BpHwAiModelMngr::_hidl_registerInstance(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, bool) | 
| 25 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 26 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 27 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 28 | 2 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_bindDeathMonitor(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, android::sp\<vendor::huawei::hardware::ai::hidlrequest::V1_0::IDeathMonitor> const&) | 
| 29 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 30 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 31 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 32 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 33 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 34 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 35 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 36 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 37 | 21 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_allocMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, int, std::__1::function<void ()(int, android::hardware::hidl_memory const&)>) | 
| 38 | 1 | 	vendor.huawei.hardware.ai.hidlrequest@1.0::IHidlRequest| vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec\<android::hardware::hidl_handle> const&)>) | 
| 39 | 22 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_freeMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, android::hardware::hidl_memory const&) | 
| 40 | 22 | 	vendor.huawei.hardware.ai@3.0::IAiModelMngr| vendor::huawei::hardware::ai::V3_0::BpHwAiModelMngr::_hidl_freeMemory(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, android::hardware::hidl_string const&, android::hardware::hidl_memory const&) | 

related files are collected in the meantime, they are:
```
vendor/lib64/vendor.huawei.hardware.ai.hidlrequest@1.0.so
vendor/lib64/vendor.huawei.hardware.ai@1.1.so
vendor/lib64/vendor.huawei.hardware.ai@1.3.so
vendor/lib64/vendor.huawei.hardware.ai@3.0.so
```

The `_hidl_execute` is likely to be a good target for fuzzing. It's prototype and related `bp` code is collected (by using `AnalysisInterface.idc`) as below.
```
F: 0x13228 - 0x13618: vendor::huawei::hardware::ai::hidlrequest::V1_0::BpHwHidlRequest::_hidl_execute(android::hardware::IInterface *, android::hardware::details::HidlInstrumentor *, int, int, android::hardware::hidl_vec<android::hardware::hidl_handle> const&, std::__1::function<void ()(int, android::hardware::hidl_vec<android::hardware::hidl_handle> const&)>)
C: 0x132BC -> 0x22030: android::hardware::Parcel::writeInterfaceToken(char const*)
C: 0x132D0 -> 0x22040: android::hardware::Parcel::writeInt32(int)
C: 0x132E4 -> 0x22040: android::hardware::Parcel::writeInt32(int)
C: 0x13300 -> 0x22050: android::hardware::Parcel::writeBuffer(void const*, unsigned long, unsigned long *)
C: 0x13328 -> 0x22060: android::hardware::Parcel::writeEmbeddedBuffer(void const*, unsigned long, unsigned long *, unsigned long, unsigned long)
C: 0x13358 -> 0x22070: android::hardware::writeEmbeddedToParcel(android::hardware::hidl_handle const&, android::hardware::Parcel *, unsigned long, unsigned long)
T: Transaction code at 0x13398: 1
```

## S2: 
After that, we enable the interface token and transaction code filter to get the `Parcel` data, the `mData` within the `Parcel` are:
```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
73ea85a980  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
73ea85a990  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
73ea85a9a0  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
73ea85a9b0  52 65 71 75 65 73 74 00 00 00 00 00 0b 00 00 00  Request.........
73ea85a9c0  85 2a 74 70 00 00 00 00 f0 a3 b5 d0 7f 00 00 00  .*tp............
73ea85a9d0  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73ea85a9e0  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
73ea85a9f0  28 0e 51 89 73 00 00 00 00 00 00 00 00 00 00 00  (.Q.s...........
73ea85aa00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
```

```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
73ea85a980  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
73ea85a990  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
73ea85a9a0  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
73ea85a9b0  52 65 71 75 65 73 74 00 00 00 00 00 1f 00 00 00  Request.........
73ea85a9c0  85 2a 74 70 00 00 00 00 80 a3 b5 d0 7f 00 00 00  .*tp............
73ea85a9d0  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73ea85a9e0  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
73ea85a9f0  08 60 df 89 73 00 00 00 00 00 00 00 00 00 00 00  .`..s...........
73ea85aa00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
```

```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
73f9425500  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
73f9425510  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
73f9425520  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
73f9425530  52 65 71 75 65 73 74 00 00 00 00 00 20 00 00 00  Request..... ...
73f9425540  85 2a 74 70 00 00 00 00 80 a3 b5 d0 7f 00 00 00  .*tp............
73f9425550  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9425560  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
73f9425570  48 dd 88 ea 73 00 00 00 10 00 00 00 00 00 00 00  H...s...........
73f9425580  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9425590  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
73f94255a0  70 6e b9 89 73 00 00 00 24 00 00 00 00 00 00 00  pn..s...$.......
73f94255b0  01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f94255c0  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
73f94255d0  02 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
```
  
```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
73f94280c0  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
73f94280d0  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
73f94280e0  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
73f94280f0  52 65 71 75 65 73 74 00 00 00 00 00 11 00 00 00  Request.........
73f9428100  85 2a 74 70 00 00 00 00 20 98 b5 d0 7f 00 00 00  .*tp.... .......
73f9428110  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9428120  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
73f9428130  08 6b 7f 4d 73 00 00 00 10 00 00 00 00 00 00 00  .k.Ms...........
73f9428140  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9428150  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
73f9428160  00 ae 7f 4d 73 00 00 00 24 00 00 00 00 00 00 00  ...Ms...$.......
73f9428170  01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9428180  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
73f9428190  02 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
```

```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
740207ee00  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
740207ee10  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
740207ee20  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
740207ee30  52 65 71 75 65 73 74 00 00 00 00 00 10 00 00 00  Request.........
740207ee40  85 2a 74 70 00 00 00 00 b0 95 b5 d0 7f 00 00 00  .*tp............
740207ee50  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
740207ee60  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
740207ee70  98 ee df 58 73 00 00 00 20 00 00 00 00 00 00 00  ...Xs... .......
740207ee80  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
740207ee90  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
740207eea0  f0 ee df 58 73 00 00 00 24 00 00 00 00 00 00 00  ...Xs...$.......
740207eeb0  01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
740207eec0  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
740207eed0  02 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
740207eee0  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
740207eef0  e0 70 b9 89 73 00 00 00 24 00 00 00 00 00 00 00  .p..s...$.......
740207ef00  01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00  ................
740207ef10  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
740207ef20  04 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
```

```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
740209e000  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
740209e010  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
740209e020  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
740209e030  52 65 71 75 65 73 74 00 00 00 00 00 13 00 00 00  Request.........
740209e040  85 2a 74 70 00 00 00 00 60 9c b5 d0 7f 00 00 00  .*tp....`.......
740209e050  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
740209e060  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
740209e070  08 19 d6 58 73 00 00 00 30 00 00 00 00 00 00 00  ...Xs...0.......
740209e080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
740209e090  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
740209e0a0  00 a5 dc 90 73 00 00 00 24 00 00 00 00 00 00 00  ....s...$.......
740209e0b0  01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
740209e0c0  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
740209e0d0  02 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
740209e0e0  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
740209e0f0  20 a3 dc 90 73 00 00 00 24 00 00 00 00 00 00 00   ...s...$.......
740209e100  01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00  ................
740209e110  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
740209e120  04 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
740209e130  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
740209e140  50 a3 dc 90 73 00 00 00 24 00 00 00 00 00 00 00  P...s...$.......
740209e150  01 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00  ........ .......
740209e160  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
740209e170  06 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
```

```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
73f94267c0  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
73f94267d0  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
73f94267e0  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
73f94267f0  52 65 71 75 65 73 74 00 00 00 00 00 1b 00 00 00  Request.........
73f9426800  85 2a 74 70 00 00 00 00 80 9d b5 d0 7f 00 00 00  .*tp............
73f9426810  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9426820  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
73f9426830  68 c1 dc 90 73 00 00 00 10 00 00 00 00 00 00 00  h...s...........
73f9426840  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9426850  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
73f9426860  40 99 db 7b 73 00 00 00 24 00 00 00 00 00 00 00  @..{s...$.......
73f9426870  01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9426880  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
73f9426890  02 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
```

```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
73f94267c0  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
73f94267d0  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
73f94267e0  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
73f94267f0  52 65 71 75 65 73 74 00 00 00 00 00 14 00 00 00  Request.........
73f9426800  85 2a 74 70 00 00 00 00 10 9b b5 d0 7f 00 00 00  .*tp............
73f9426810  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9426820  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
73f9426830  a8 c3 dc 90 73 00 00 00 10 00 00 00 00 00 00 00  ....s...........
73f9426840  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9426850  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
73f9426860  20 91 dc 90 73 00 00 00 24 00 00 00 00 00 00 00   ...s...$.......
73f9426870  01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
73f9426880  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
73f9426890  02 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
```

```
             0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
737b42d200  76 65 6e 64 6f 72 2e 68 75 61 77 65 69 2e 68 61  vendor.huawei.ha
737b42d210  72 64 77 61 72 65 2e 61 69 2e 68 69 64 6c 72 65  rdware.ai.hidlre
737b42d220  71 75 65 73 74 40 31 2e 30 3a 3a 49 48 69 64 6c  quest@1.0::IHidl
737b42d230  52 65 71 75 65 73 74 00 00 00 00 00 16 00 00 00  Request.........
737b42d240  85 2a 74 70 00 00 00 00 a0 8d 91 47 73 00 00 00  .*tp.......Gs...
737b42d250  10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
737b42d260  00 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  .........*tp....
737b42d270  08 0c 11 7c 73 00 00 00 30 00 00 00 00 00 00 00  ...|s...0.......
737b42d280  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
737b42d290  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
737b42d2a0  40 3c 3f f5 73 00 00 00 24 00 00 00 00 00 00 00  @<?.s...$.......
737b42d2b0  01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
737b42d2c0  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
737b42d2d0  02 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
737b42d2e0  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
737b42d2f0  70 3c 3f f5 73 00 00 00 24 00 00 00 00 00 00 00  p<?.s...$.......
737b42d300  01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00  ................
737b42d310  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
737b42d320  04 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
737b42d330  24 00 00 00 00 00 00 00 85 2a 74 70 01 00 00 00  $........*tp....
737b42d340  a0 3c 3f f5 73 00 00 00 24 00 00 00 00 00 00 00  .<?.s...$.......
737b42d350  01 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00  ........ .......
737b42d360  85 61 64 66 00 00 00 00 01 00 00 00 00 00 00 00  .adf............
737b42d370  06 00 00 00 00 00 00 00 0c 00 00 00 00 00 00 00  ................
```

**Note:** 
1) The transaction is processed multiple times, such that we get a collection of transactions; 
2) The prototype of `_hidl_execute` accepts 4 arguments, 2 `int`s, one `hidl_vec<hidl_handle>`, and one `callback`. Pay attention to the second `int` in the `mData`, I guess it's an important indication to tell these `Parcel`s apart;
3) The layout of `mData` is like below, the first and the second block do not ended with `BINDER_TYPE_FDA`, which means an empty `hidl_vec` is delivered.

`hidl_vec<hidl_handle>` within 

```
0                0x38  0x3c  0x40       0x68                    0x90                 0x98          0xc0       0xe8
|-----------------|-----|-----|----------|-----------------------|--------------------|-------------|----------|----- 
| interface token | int | int | hidl_vec | hidl_vec<hidl_handle> | native_handle_size | hidl_handle | fd_array | ...    
```
 

 